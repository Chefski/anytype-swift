default_platform(:ios)

platform :ios do

  lane :dev do
    match(readonly: true)
    
    build_number = increment_build_number(xcodeproj: "Anytype.xcodeproj")
    version = get_version_number(xcodeproj: "Anytype.xcodeproj")

    add_badge(
      grayscale: true,
      shield: "#{version}-#{build_number}-blue",
      no_badge: true
    )
    build_app(scheme: "Anytype", configuration: "Dev-Release")
    upload_to_testflight(skip_waiting_for_build_processing: true)
  end

  lane :release do
    match(readonly: true)
    increment_build_number(xcodeproj: "Anytype.xcodeproj")
    build_app(scheme: "Anytype", configuration: "Release")
    upload_to_testflight(skip_waiting_for_build_processing: true)
  end


  lane :install_dev_profiles do
    match(readonly: true)
  end

  lane :generate_dev_profiles do
    match(force_for_new_devices: true)
  end

end
